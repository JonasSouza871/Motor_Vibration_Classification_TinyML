# Firmware for Raspberry Pi Pico (RP2040)

## Description

This folder contains the C firmware for motor speed classification on Raspberry Pi Pico with MPU6050 sensor and SSD1306 OLED display.

## Structure

```
firmware/
â”œâ”€â”€ libs/                     # Header files
â”‚   â”œâ”€â”€ motor_model.h         # TFLite model array (generated by notebook)
â”‚   â”œâ”€â”€ scaler_params.h       # Normalization parameters (generated by notebook)
â”‚   â”œâ”€â”€ mpu6050.h             # MPU6050 sensor driver
â”‚   â”œâ”€â”€ ssd1306.h             # SSD1306 OLED display driver
â”‚   â””â”€â”€ font.h                # Font bitmap for display
â”‚
â”œâ”€â”€ src/                      # Source files
â”‚   â”œâ”€â”€ main.c                # Main application
â”‚   â”œâ”€â”€ mpu6050.c             # MPU6050 implementation
â”‚   â””â”€â”€ ssd1306.c             # SSD1306 implementation
â”‚
â””â”€â”€ README.md                 # This file
```

## Auto-Generated Files (from Notebook)

After running the Jupyter notebook, the following files are automatically generated:

### `libs/motor_model.h`
- TFLite model converted to C array
- Size: ~5.25 KB
- Variable: `motor_model[]`
- Contains the trained neural network weights

### `libs/scaler_params.h`
- Normalization parameters (mean and standard deviation)
- Required to normalize sensor data before inference
- Variables: `scaler_mean[]` and `scaler_scale[]`

## Hardware Configuration

### MPU6050 Sensor (I2C0)
- **SDA:** GPIO 0
- **SCL:** GPIO 1
- **VCC:** 3.3V
- **GND:** GND
- **Address:** 0x68

### SSD1306 OLED Display (I2C1)
- **SDA:** GPIO 14
- **SCL:** GPIO 15
- **VCC:** 3.3V
- **GND:** GND
- **Address:** 0x3C
- **Resolution:** 128x64

## Features

- âœ… Real-time MPU6050 sensor reading (accelerometer + gyroscope)
- âœ… I2C communication at 400 kHz
- âœ… SSD1306 OLED display with custom font rendering
- âœ… Sensor data visualization on display
- âœ… 200ms refresh rate
- ðŸ”„ TinyML inference (upcoming)

## Current Implementation

The firmware currently implements:

1. **Dual I2C buses:** Separate buses for sensor (I2C0) and display (I2C1)
2. **MPU6050 driver:** Full sensor initialization and data reading
3. **SSD1306 driver:** Display control with graphics primitives
4. **Real-time monitoring:** Displays acceleration and gyroscope values

## Building the Firmware

See the main project [CMakeLists.txt](../CMakeLists.txt) for build configuration.

```bash
mkdir build && cd build
cmake .. -G "Ninja" -DPICO_SDK_FETCH_FROM_GIT=ON
cmake --build .
```

Output: `build/Motor_Classification_TinyML.uf2`

## Flashing to Pico

1. Hold the **BOOTSEL** button on Pico
2. Connect USB cable to computer
3. Release BOOTSEL (Pico appears as mass storage device)
4. Copy `Motor_Classification_TinyML.uf2` to the Pico drive
5. Pico will automatically reboot and run the firmware

## Dependencies

- **Pico SDK** (automatically fetched via CMake)
- **hardware_i2c** (from Pico SDK)
- **pico_stdlib** (from Pico SDK)

## Status

âœ… **Hardware integration complete** - Sensor reading and display working
ðŸ”„ **TinyML integration in progress**
